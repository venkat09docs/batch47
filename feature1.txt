This is f1 implementation
